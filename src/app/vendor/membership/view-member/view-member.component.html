<div class="card">
    <div class="card-body" >
        <div class="profile-head media">
            <a href="#" class="col-md-3 pull-left">
                <img *ngIf="!member?.passport" class="rounded-circle" src="assets/images/avata.png">
                <img *ngIf="member?.passport" class="rounded-circle" [src]="sanitizer.bypassSecurityTrustUrl(member.passport)">
            </a>
            <div class="col-md-9">
                <h2>
                    {{member?.first_name}} 
                    {{member?.last_name}} 
                    {{member?.middle_name}} 
                </h2>
                <p class="profile-brief">
                    {{member?.email}}
                </p>
                <!--  <p *ngIf="!vendor.description" class="profile-brief">
                    Description
                </p> -->
                <div class="profile-details muted">
                    <h3><a class="btn pull-left"><i class="fa fa-money shaded"></i> Contribution : &#8358;  {{member?.contribution}} </a></h3>
                    <h3><a class="btn"><i class="fa fa-phone shaded"></i> {{member?.phone1}}, {{member?.phone2}} </a></h3>
                </div>
                <div class="profile-details muted">
                    <h3><a class="btn pull-left"><i class="fa fa-balance-scale shaded"></i> Contribution Balance:<span class="label label-sm label-success"> &#8358; {{ member?.contribution_balance || 0 }} </span></a></h3>
                    <h3><a class="btn pull-left"><i class="fa fa-balance-scale shaded"></i> 
                        Total Deduction: <span class="label label-sm label-danger"> &#8358; {{ total_deduction || 0 }} </span></a></h3>
                    <h3><a class="btn"><i class="fa fa-phone shaded"></i> {{member?.phone1}}, {{member?.phone2}} </a></h3>
                </div>
                <div class="row text-centr buttons">
                                    <div class="col">
                                        <div class="row flex-items-xs-middle">
                                            <div class="col">
                                                <button type="button" class="btn btn-facebook btn-circle btn-outline btn-xs">
                                                    <i class="fa fa-facebook"></i>
                                                </button>
                                                <button type="button" class="btn btn-twitter btn-circle btn-outline btn-xs">
                                                    <i class="fa fa-twitter"></i>
                                                </button>
                                                <button type="button" class="btn btn-youtube btn-circle btn-outline btn-xs">
                                                    <i class="fa fa-youtube"></i>
                                                </button>
                                    </div>
                                </div>
                            </div>
                        </div>
            </div>
        </div>
        <div class="row">
                <div class="col">
                    <tabset>
                        <tab heading="Profile">
                            <div class="row">
                                <label class="col-sm-3">First Name</label>
                                <div class="col-sm-9">
                                    <p>{{member?.first_name}}</p>
                                </div>
                            </div>
                             <div class="row">
                                <label class="col-sm-5">Middle Name</label>
                                <div class="col-sm-7">
                                    <p>{{member?.middle_name ? member?.middle_name : nill}}</p>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-5">Last Name</label>
                                <div class="col-sm-7">
                                    <p>{{member?.last_name}}</p>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-5">Email</label>
                                <div class="col-sm-7">
                                    <p>{{member?.email}}</p>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-5">Contribution</label>
                                <div class="col-sm-7">
                                    <p>{{member?.contribution}}</p>
                                </div>
                            </div>
                             <h4>Custom</h4>
                            <hr>
                            <div class="row" *ngFor="let item of member?.members">
                                <label class="col-sm-5">{{item?.key}}</label>
                                <div class="col-sm-7">
                                    <p>{{item?.information}}</p>
                                </div>
                            </div>
                        </tab>
                        <tab heading="Edit Profile">
                            <div class="col-md-8 col-offset-md-2">
                                <form #form="ngForm" (ngSubmit)="updateMember(form.value, member.id)">
                                      <div class="form-group">
                                          <label>Surname:</label>
                                        <input type="text" class="form-control" [ngModel]="member?.first_name" name="first_name" ngModel>
                                      </div>
                                      <div class="form-group">
                                        <label>Middle Name:</label>
                                        <input type="text" class="form-control" [ngModel]="member?.middle_name" name="last_name" ngModel>
                                      </div>
                                      <div class="form-group">
                                        <label>Last Name:</label>
                                      <input type="text" class="form-control" [ngModel]="member?.last_name" name="middle_name" ngModel>
                                      </div>
                                      <div class="form-group">
                                        <label>Email:</label>
                                      <input type="text" class="form-control" [ngModel]="member?.email" name="email" ngModel>
                                      </div>
                                      <div class="form-group">
                                        <label>Contribution:</label>
                                      <input type="text" class="form-control" [ngModel]="member?.contribution" name="contribution" ngModel>
                                      </div>
                                      <div class="form-group">
                                        <label>Mobile Number:</label>
                                      <input type="text" class="form-control" [ngModel]="member?.phone1" value="" name="phone1" ngModel>
                                      </div>
                                      
                                      
                                      
                                      <!-- <label>Street:</label>
                                      <input type="text" name="street" ngModel> -->
                                     <!-- <div class="control-group">
                                        <label class="control-label" for="basicinput">Passport</label>
                                        <div class="controls">
                                            <img *ngIf="!file_srcs[0]" src="assets/images/avata.png">
                                            <img [attr.src]='file_srcs[0]' alt=""/>
                                            <input type="file" name="" (change)="fileChange(input)" #input>
                                        </div>
                                    </div> -->
                                    <h4>Custom Form Field</h4>
                                    <div ngModelGroup="member_details" class="control-group" *ngFor="let item of membersFormPoolList;  let i = index; trackBy:trackByIndex">
                                    <label class="control-label">{{item.label}}</label>
                                    <div *ngFor="let mem of member.members">
                                        
                                        <div class="form-group" *ngIf="item.label === mem.key">
                                            <input type="text" *ngIf="item.type =='text'" ngModel placeholder="" [ngModel]="mem?.information" name="{{mem.id}}" class="form-control">
                                            <textarea class="form-control" name="{{mem.id}}"  *ngIf="item.type =='textarea'" [ngModel]="mem?.information" ngModel></textarea>
                                        </div>
                                        <!-- <div class="controls" *ngIf="mem.key!=item.label">
                                            <input type="text" *ngIf="item.type =='text'" ngModel placeholder="" name="{{item.label}}" class="form-control">
                                            <textarea class="form-control" name="{{item.label}}"  *ngIf="item.type =='textarea'" ngModel></textarea>
                                        </div> -->
                                    </div>
                                    </div>
                                      <button type="submit" class="btn btn-primary btn-block" [disabled]="form.invalid || submitPending ">
                                        <span *ngIf="!submitPending">Update</span>
                                        <span *ngIf="submitPending && form.valid">Please Wait...</span>
                                        <span *ngIf="submitPending && form.valid" class="fa fa-spinner" aria-hidden="true"></span>
                                    </button>
                                </form>
                            </div>
                        </tab>
                        <tab heading="CONTRIBUTIONS">
                            <div class="row">
                                <table class="table table-responsive-sm table-hover table-outline mb-0" width="100%">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <!-- <th>Name</th> -->
                                            <th>Contribution</th>
                                            <th>Contributed</th>
                                            <th>Status</th>
                                            <th>Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="" *ngFor="let item of memberContributionList">
                                            <td><input type="checkbox" name=""></td>
                                          <!--   <td>
                                                {{item.user.first_name}} 
                                                {{item.user.last_name}} 
                                                {{item.user?.middle_name}} 
                                                </td> -->
                                            <td>
                                                &#8358; {{item?.member?.contribution}} 
                                            </td>
                                            <td>
                                               &#8358; {{item?.amount}}  
                                            </td>
                                              <td>
                                                <p *ngIf="item?.status == 1">
                                                    Paid
                                                </p> 
                                                <p *ngIf="item?.status != 1">
                                                    Pending
                                                </p> 
                                            </td>
                                            <td>
                                                {{item?.created_at}} 
                                            </td>
                                            <td class="center">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </tab>
                        <tab heading="DEDUCTIONS">
                            <div class="row">
                                <table class="table table-responsive-sm table-hover table-outline mb-0" width="100%">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Loan Type</th>
                                            <th>Method</th>
                                            <th>Deducted</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="" *ngFor="let item of memberLoanDeductionsList">
                                            <td><input type="checkbox" name=""></td>
                                            <td>
                                                {{item?.type.loan_type}} 
                                            </td>
                                            <td>
                                                {{item?.repayment_method}} 
                                            </td>
                                            <td>
                                                &#8358; {{item?.amount_deducted}} 
                                            </td>
                                              <td>
                                                {{item?.created_at}} 
                                            </td>
                                              <td>
                                                {{item?.status}} 
                                            </td>
                                            <td class="center">
                                                
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </tab>
                        <tab heading="LOAN REQUEST">
                            <div class="row">
                                <div class="col-md-12">
                                    <button type="button" class="btn btn-success pull-right" (click)="newLoanRequestModal.show()">
                                        <i class="fa fa-plus"></i> 
                                    Make A Loan Request
                                    </button>
                                </div>
                                <table class="table table-responsive-sm table-hover table-outline mb-0" width="100%">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <!-- <th>Name</th> -->
                                            <th>Loan Type</th>
                                            <th>Amount</th>
                                            <th>Monthly Deductions</th>
                                            <th>Repayment Method</th>
                                            <th>Duration(Months)</th>
                                            <th>Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="" *ngFor="let item of memberLoanRequestList">
                                            <td><input type="checkbox" name=""></td>
                                            <!-- <td>
                                                {{item.member.first_name}} 
                                                {{item.member.last_name}} 
                                                {{item.member?.middle_name}} 
                                                </td> -->
                                            <td>
                                                {{item?.type?.loan_type}} 
                                            </td>
                                            <td>
                                                &#8358; {{item?.amount}} 
                                            </td>
                                            <td>
                                                &#8358; {{item?.monthly_deductions}} 
                                            </td>
                                            <td>
                                                {{item?.repayment_method}} 
                                            </td>
                                            <td>
                                                {{item?.type.duration}} 
                                            </td>
                                              <td>
                                                {{item?.created_at}} 
                                            </td>
                                              <td>
                                                {{item?.status}} 
                                            </td>
                                            <td class="center">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </tab>
                    </tabset>
                </div>
            </div>
    </div>
    <!--/.module-body-->
</div>

<!-- new loan type modal -->
<div bsModal #newLoanRequestModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
     <div class="modal-dialog modal-md">
       <div class="modal-content">
         <div class="modal-header">
           <h4 class="modal-title pull-left">New Loan Request</h4>
           <button type="button" class="close pull-right" aria-label="Close" (click)="newLoanRequestModal.hide()">
             <span aria-hidden="true">&times;</span>
           </button>
         </div>
         <div class="modal-body">
           <div class="new session form">
              <form method="POST" [formGroup] = "loanRequestForm" (ngSubmit) = "makeLoanRequest(loanRequestForm.value)" class="form-horizontal row-fluid">
                <div class="control-group">
                    <label class="col-sm-5">Type Name</label>
                    <div class="col-sm-7">
                        <select class="form-control" formControlName="loan_type">
                            <option value="{{item.id}}" *ngFor="let item of loanTypeList">
                                {{item.loan_type}}
                                <small>{{item.minimum_amount}}- {{item.maximum_amount}} 
                                ({{item.duration}} Months)</small>
                            </option>
                        </select>
                        <small [hidden]="(loanRequestForm.controls.loan_type.valid ) || (loanRequestForm.controls.loan_type.pristine && !submitted)" class="text-danger">Loan Type Name is Required</small>
                    </div>
                </div>
                <div class="control-group">
                    <label class="col-sm-5">Repayment Method</label>
                    <div class="col-sm-7">
                        <select class="form-control" formControlName="repayment_method">
                            <option value="salary">Salary Deduction</option>
                            <option value="repayment">Individual Repayment</option>
                            <option value="both">Both</option>
                        </select>
                         <small [hidden]="(loanRequestForm.controls.repayment_method.valid ) || (loanRequestForm.controls.repayment_method.pristine && !submitted)" class="text-danger">Method of Repayment Required</small>
                    </div>
                </div>
                <div class="control-group">
                    <label class="col-sm-5">Amount <small>[ NGN ]</small></label>
                    <div class="col-sm-7">
                        <input type="number" formControlName="amount" placeholder="Amount" class="form-control" required="">
                        <small [hidden]="(loanRequestForm.controls.amount.valid ) || (loanRequestForm.controls.amount.pristine && !submitted)" class="text-danger">Method of Repayment Required</small>
                    </div>
                </div>
                <div class="control-group">
                    <label class="col-sm-5">Description</label>
                    <div class="col-sm-7">
                        <textarea class="form-control" formControlName="description" placeholder="Reasons for loan request"></textarea>
                    </div>
                </div>
                <div class="control-group">
                    <label class="col-sm-5">Requirements</label>
                    <div class="col-sm-7">
                       
                        <input type="file" multiple (change)="onChange($event, showFileNames)" />
                    </div>
                </div>
                <div><small>please  note that once loans are approve it cannot be canceled</small></div>
                <div class="control-group mbn">
                    <div class="col-sm-12 ">
                        <button type="submit" class="btn btn-success btn-block" [disabled]="loanRequestForm.invalid || submitPending ">
                                <span *ngIf="!submitPending">Create</span>
                                <span *ngIf="submitPending && loanRequestForm.valid">Please Wait...</span>
                                <span *ngIf="submitPending && loanRequestForm.valid" class="fa fa-spinner" aria-hidden="true"></span>
                            </button>
                    </div>
                </div>
            </form>
            </div>
         </div>
       </div>
     </div>
</div>
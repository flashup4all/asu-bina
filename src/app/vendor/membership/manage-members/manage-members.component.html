<div class="animated fadeIn">
  <div class="row">
    <div class="col-sm-12 col-lg-4">
      <div class="card text-white bg-primary">
        <div class="card-body pb-0">
          <h4 class="mb-0">{{ total_members }}</h4>
          <p>Total Members</p>
        </div>
      </div>
    </div>
    <div class="col-sm-12 col-lg-4">
      <div class="card text-white bg-success">
        <div class="card-body pb-0">
          <h4 class="mb-0"> {{ total_active_members }}</h4>
          <p>Active Members
        </div>
      </div>
    </div>
    <div class="col-sm-12 col-lg-4">
      <div class="card text-white bg-warning">
        <div class="card-body pb-0">
          <h4 class="mb-0"> {{ total_members - total_active_members }}</h4>
          <p>Inactive Members/Suspended
        </div>
      </div>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-body">
    <div class="row">
      <div class="col">
        <tabset>
            <tab heading="Members">
                <div class="col-md-12">
                    <div class="row">
                      <form class="pull-left">
                        <div class="input-append">
                            <input type="text" [formControl]="queryField" class="span3" placeholder="Filter by name...">
                            <button type="submit" class="btn">
                                <i class="icon-search"></i>
                            </button>
                        </div>
                        <button class="btn btn-success" (click)="excelUploadModal.show()">Upload Excel Format</button>
                      </form>
                      <div class="pull-right">
                        <button class="btn btn-success pull-left" (click)="activateAllMember()">Activate All Members</button>
                        <button class="btn btn-danger pull-right" (click)="deactivateAllMember()">Deactivate All Members</button>
                      </div>
                      <table class="table table-responsive-sm table-hover table-outline mb-0">
                        <thead class="thead-light">
                          <tr>
                            <th class="text-center"><i class="icon-people"></i></th>
                            <th>Name</th>
                            <th class="text-center">Email</th>
                            <th>Contribution</th>
                            <th>status</th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        <tbody>
                          <!-- search result -->
                          <tr *ngFor="let item of results">
                            <td class="text-center">
                              <div class="avatar">
                                <img *ngIf="!item.passport" title="{{item?.first_name}} {{item?.middle_name}} {{item?.last_name}}" src="assets/images/avata.png" class="img-avatar">
                                <img *ngIf="item.passport" [src]="sanitizer.bypassSecurityTrustUrl(item.passport)" title="{{item?.first_name}} {{item?.middle_name}} {{item?.last_name}}" class="img-avatar">
                                <span class="avatar-status badge-success"></span>
                              </div>
                            </td>
                            <td>
                              <div>{{item?.first_name}} {{item?.middle_name}} {{item?.last_name}}</div>
                              <div class="small text-muted">
                                <span>{{item?.gender}}</span> | {{item?.phone1 || 'nil'}}
                              </div>
                            </td>
                            <td class="text-center">
                              {{item.email}}
                            </td>
                            <td class="text-center">
                              <span class="label label-sm label-primary">{{ item?.contribution}}</span>
                            </td>
                            <td>
                              <small *ngIf="item.status == 1" class="muted pull-right">
                                 <h4><span class="label label-sm label-success">Active</span></h4>
                              </small>
                              <small *ngIf="item.status == 2" class="muted pull-right">
                                 <h4><span class="label label-sm label-warning">Blocked</span></h4>
                              </small>
                              <small *ngIf="item.status == 0" class="muted pull-right">
                                 <h4><span class="label label-sm label-danger">Inactive</span></h4>
                              </small>
                            </td>
                            <td>
                              <a class="btn btn-primary btn-sm" [routerLink]="['/app/members/', item.id,'view']" title="edit member details">
                                <i class="fa fa-sliders"> </i></a>
                              <button class="btn btn-success btn-sm" (click)="editPassword(item)" title="reset member password: this sends a password reset link"><i class="fa fa-key"></i></button>
                              <button class="btn btn-danger btn-sm" *ngIf="item.status == 1" (click)="deactivateMember(item.id)" title="deactivate or suspend this member">
                                <i class="fa fa-unlock"></i></button>
                              <button class="btn btn-success btn-sm" *ngIf="item.status != 1" (click)="activateMember(item.id)" title="activate this member"><i class="fa fa-unlock"></i></button>
                            </td>
                          </tr>
                          <!-- staff list -->
                          <tr *ngFor="let item of membersList">
                            <td class="text-center">
                              <div class="avatar">
                                <img *ngIf="!item.passport" title="{{item?.first_name}} {{item?.middle_name}} {{item?.last_name}}" src="assets/images/avata.png" class="img-avatar">
                                <img *ngIf="item.passport" [src]="sanitizer.bypassSecurityTrustUrl(item.passport)" title="{{item?.first_name}} {{item?.middle_name}} {{item?.last_name}}" class="img-avatar">
                                <span class="avatar-status badge-success"></span>
                              </div>
                            </td>
                            <td>
                              <div>{{item?.first_name}} {{item?.middle_name}} {{item?.last_name}}</div>
                              <div class="small text-muted">
                                <span>{{item?.gender}}</span> | {{item?.phone1 || 'nil'}}
                              </div>
                            </td>
                            <td class="text-center">
                              {{item.email}}
                            </td>
                            <td class="text-center">
                              <span class="label label-sm label-primary">{{ item?.role?.name}}</span>
                            </td>
                            <td>
                              <small *ngIf="item.status == 1" class="muted pull-right">
                                 <h4><span class="label label-sm label-success">Approved</span></h4>
                              </small>
                              <small *ngIf="item.status == 2" class="muted pull-right">
                                 <h4><span class="label label-sm label-warning">Blocked</span></h4>
                              </small>
                              <small *ngIf="item.status == 0" class="muted pull-right">
                                 <h4><span class="label label-sm label-danger">Inactive</span></h4>
                              </small>
                            </td>
                            <td>
                              <a class="btn btn-primary btn-sm" [routerLink]="['/app/members/', item.id,'view']" title="edit member details">
                                <i class="fa fa-sliders"> </i></a>
                              <button class="btn btn-success btn-sm" (click)="editPassword(item)" title="reset member password: this sends a password reset link"><i class="fa fa-lock"></i></button>
                              <button class="btn btn-danger btn-sm" *ngIf="item.status == 1" (click)="deactivateMember(item.id)" title="deactivate or suspend this member">
                                <i class="fa fa-unlock"></i></button>
                              <button class="btn btn-success btn-sm" *ngIf="item.status != 1" (click)="activateMember(item.id)" title="activate this member"><i class="fa fa-unlock"></i></button>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                </div>
            </tab>
            <tab heading="New Member">
                <div class="col-md-12">
                    <div class="row">
                      <form [formGroup]="newMemberForm" (ngSubmit)="addMember(newMemberForm.value)">
                        <div class="form-group">
                          <label>Surname:</label>
                          <input type="text" name="first_name" class="form-control" formControlName="first_name">
                        </div>
                         <div class="form-group">
                          <label>Lastname:</label>
                          <input type="text" class="form-control" name="last_name" formControlName="last_name">
                        </div>
                        <div class="form-group">
                          <label>Other Names:</label>
                          <input type="text" class="form-control" name="middle_name" formControlName="middle_name">
                        </div>
                        <div class="form-group">
                          <label>Email:</label>
                          <input type="text" name="email" class="form-control" formControlName="email">
                        </div>
                        <div class="form-group">
                          <label>Contribution:</label>
                          <input type="number" min="0" class="form-control" name="contribution" formControlName="contribution">
                        </div>
                        <div class="form-group">
                          <label>Mobile Number:</label>
                        <input type="text" class="form-control" name="phone1" formControlName="phone1">
                        <small>Note: this number will serve as the authentication number</small>
                        </div>
                        <div class="form-group">
                          <label>Gender:</label>
                          <select class="form-control" name="gender" formControlName="gender">
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                          </select>
                        </div>
                        <div class="form-group">
                          <label class="control-label" for="basicinput">Passport</label>
                              <img *ngIf="!file_srcs[0]" src="assets/images/avata.png">
                              <img [attr.src]='file_srcs[0]' *ngIf="file_srcs[0]" alt="" width="250px" height="250px" />
                              <input type="file" name="" (change)="fileChange(input)" #input>
                        </div>
                        
                        <!-- <label>Street:</label>
                        <input type="text" name="street" ngModel> -->
                       <div class="control-group">
                          
                      </div>
                      <h4>Custom Form Field</h4>
                      <div *ngFor="let fields of newMemberForm.controls.memberData.controls; let i=index">
                        <div class="form-group">
                          <label>{{ membersFormPoolList[i].label }}</label>
                          <input type="text" *ngIf="membersFormPoolList[i].type =='text'" placeholder="{{membersFormPoolList[i].placeholder}}" [formControl]="fields.controls.key" class="form-control">
                          <textarea class="form-control"  [formControl]="fields.controls.key"  *ngIf="membersFormPoolList[i].type =='textarea'"  placeholder="{{membersFormPoolList[i].placeholder}}" ></textarea>
                      </div>
                    </div>
                        <button type="submit" class="btn btn-primary btn-block" [disabled]="submitPending ">
                        <span *ngIf="!submitPending">Submit</span>
                        <span *ngIf="submitPending">Please Wait...</span>
                        <span *ngIf="submitPending" class="fa fa-spinner" aria-hidden="true"></span>
                    </button>
                  </form>
                    </div>
                </div>
            </tab>
        </tabset>
      </div>
    </div>
  </div>
</div>
<div class="module">
  <div class="module-body">
      <ul class="profile-tab nav nav-tabs">
          <li class="active"><a href="#friends" data-toggle="tab">MEMBER</a></li>
          <li><a href="#activity" data-toggle="tab">NEW MEMBER</a></li>
      </ul>
      <div class="profile-tab-content tab-content">
          <div class="tab-pane fade" id="activity">
          	<div class="">
               <div class="new session form">
            <div class="">
                    
                </div>
              </div> 
              </div>
          </div>
          <div class="tab-pane fade active in" id="friends">
            
               <div class="row module-option clearfix">
                 <div *ngIf="results">
                      <div class="col-md-6" *ngFor="let item of results">
                          <div class="media user" title="{{item.first_name}} {{item?.middle_name}} {{item.last_name}}">
                          <div class="">
                                  <div class="btn-group">
                                    <!-- <button class="btn btn-mini">Action</button> -->
                                    <button class="btn btn-mini dropdown-toggle" data-toggle="dropdown">
                                      <span><i class="fa fa-ellipsis-v"></i></span>
                                    </button>
                                    <ul class="dropdown-menu" style="min-width:1px;">
                                      <li>
                                          <a class="" [routerLink]="['/coorp/member/', item.id,'view']" title="edit member details">
                                          <button class="btn btn-block" ><i class="fa fa-sliders"> </i> Manage
                                          </button>
                                      </a>
                                      </li>
                                      <li>
                                          <a (click)="editPassword(item)" title="reset member password: this sends a password reset link">
                                          <button class="btn btn-block" ><i class="fa fa-lock"></i> 
                                          Change Password</button>
                                      </a>
                                      </li>
                                      <li>
                                          <a *ngIf="item.status == 1" (click)="deactivateMember(item.id)" title="deactivate or suspend this member">
                                          <button class="btn btn-block" >
                                          <i class="fa fa-hourglass-start"></i>
                                           De-activate</button>
                                      </a>
                                       <a *ngIf="item.status != 1" (click)="activateMember(item.id)" title="activate this member">
                                          <button class="btn btn-block" >
                                          <i class="fa fa-hourglass-start"></i>
                                           Activate</button>
                                      </a>
                                      </li>
                                       <!-- <li class="divider"></li>
                                      <li>
                                          <a (click)="deleteMember(item.id)" title="delete member">
                                             <button class="btn btn-block" >
                                             <i class="fa fa-trash-o"></i>
                                               Delete</button>
                                          </a>
                                      </li>
                                       <li class="divider"></li> -->
                                    </ul>
                                  </div>
                          </div>
                              <a class="media-avatar pull-left" href="#">
                                  <img *ngIf="!item.passport" src="assets/images/avata.png">
                                  <img *ngIf="item.passport" [src]="sanitizer.bypassSecurityTrustUrl(item.passport)">
                              </a>
                              <div class="media-body">
                                  <h3 class="media-title">
                                      {{item.first_name}} {{item.last_name}} 
                                      {{item?.middle_name}}
                                  </h3>
                                  <p>
                                      <small class="muted">{{item.email}}</small>
                                  </p>
                                   <p>
                                      <small class="muted">{{item.phone1}}</small>
                                  </p>
                                  <p>
                                      <small class="muted">{{item.gender}}</small>
                                  </p>
                                  <p>
                                      <small class="muted pull-left"><h5>&#8358; {{item.contribution}}</h5></small>
                                      <small *ngIf="item.status == 1" class="muted pull-right">
                                         <h4><span class="label label-sm label-success">Approved</span></h4>
                                      </small>
                                      <small *ngIf="item.status == 2" class="muted pull-right">
                                         <h4><span class="label label-sm label-warning">Blocked</span></h4>
                                      </small>
                                      <small *ngIf="item.status == 0" class="muted pull-right">
                                         <h4><span class="label label-sm label-danger">Inactive</span></h4>
                                      </small>
                                  </p>
                                  <div class="media-option btn-group shaded-icon">
                                      <!-- <button class="btn btn-small" (click)="editStaff(item)" title="edit staff details">
                                          <i class="fa fa-edit"></i>
                                      </button>
                                      <button class="btn btn-small" (click)="deleteStaff(item.id)" title="delete staff">
                                          <i class="fa fa-trash-o"></i>
                                      </button> -->
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
               </div>
              <div class="module-body">
                  <div class="media stream load-more">
                     <a  (click)="loadMore()" style="cursor: pointer;"><i *ngIf="loader" class="fa fa-spinner"></i>Load more... </a>
                  </div>
                  <!-- <div class="pagination pagination-centered">
                      <ul>
                          <li><a href="#"><i class="icon-double-angle-left"></i></a></li>
                          <li><a href="#">1</a></li>
                          <li><a href="#">2</a></li>
                          <li><a href="#">3</a></li>
                          <li><a href="#">4</a></li>
                          <li><a href="#"><i class="icon-double-angle-right"></i></a></li>
                      </ul>
                  </div> -->
              </div>
          </div>
      </div>
  </div>
  <!--/.module-body-->
</div>
<!-- new staff modal -->
<div bsModal #passwordModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
	 <div class="modal-dialog modal-md">
	   <div class="modal-content">
	     <div class="modal-header">
	       <h4 class="modal-title pull-left">Change Password or Send a Password Reset Link</h4>
	       <button type="button" class="close pull-right" aria-label="Close" (click)="passwordModal.hide()">
	         <span  (click)="passwordModal.hide()" aria-hidden="true">&times;</span>
	       </button>
	     </div>
	     <div class="modal-body">
	       <div class="new session form">
	       		<div class="password-rest">
	       			<h4>
						<button type="submit"  (click)="resetPassword(editMemberData)" class="btn btn-primary btn-block" title="send a password reset link to this member">Send Password Reset Link</button>
						<br>
						<!-- Or fill the form below -->
	       			</h4>
	       		</div>
		       <!-- <form [formGroup] = "changePasswordForm" (ngSubmit) = "changePassword(changePasswordForm.value, editMemberData.id)" class="form-horizontal row-fluid">
					<div class="control-group">
						<label class="control-label" for="basicinput">Old Password</label>
						<div class="controls">
							<input type="password" id="basicinput" formControlName="old_password" placeholder="Old Password" class="span8">
							
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="basicinput">New Password</label>
						<div class="controls">
							<input type="password" id="basicinput" formControlName="new_password" placeholder="New Password" class="span8">
							
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="basicinput">New Password Again</label>
						<div class="controls">
							<input type="password" id="basicinput" formControlName="new_password_confirm" placeholder="New Password" class="span8">
							
						</div>
					</div>
					<div class="control-group">
						<div class="controls">
							<button type="submit" class="btn btn-primary btn-block" [disabled]="changePasswordForm.invalid || submitPending ">
			                	<span *ngIf="!passwordFormCheck">Change Password</span>
			                	<span *ngIf="passwordFormCheck && changePasswordForm.valid">Please Wait...</span>
			                	<span *ngIf="passwordFormCheck && changePasswordForm.valid" class="fa fa-spinner" aria-hidden="true"></span>
			            	</button>
						</div>
					</div>
				</form> -->
			</div>
	     </div>
	   </div>
	 </div>
</div>
<div bsModal #excelUploadModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
     <div class="modal-dialog modal-md">
       <div class="modal-content">
         <div class="modal-header">
           <h4 class="modal-title pull-left">Upload Excel Format</h4>
           <button type="button" class="close pull-right" aria-label="Close" (click)="excelUploadModal.hide()">
             <span aria-hidden="true">&times;</span>
           </button>
         </div>
         <div class="modal-body">
          <!-- <button class="btn btn-success"><a href="http://localhost:8000/excels/contributions-format.xls" target="_blank">generate Excel format</a></button> -->
            <div class="new session form">
                <form>
                  <div class="form-group">
                    please ensure it's the generated excel format you used else it wont upload
                  </div>
                  <div class="form-group">
                    <label>Members File</label>
                    <input id="fileChooseAFile" #data type="file" class="form-control" (change)="handleFile($event)"  name="fileChooseAFile" accept=".csv, .xlsx">
                  </div>
                  <div class="form-group">
                    <button (click)="uploadExcelFormat();" class="btn btn-success">Upload</button>
                  </div>
                </form>
            </div>
         </div>
       </div>
     </div>
</div>